/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/renderer/canvas/ImageLayer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();import CanvasLayerRenderer from"./Layer.js";import ViewHint from"../../ViewHint.js";import{ENABLE_RASTER_REPROJECTION}from"../../reproj/common.js";import{IMAGE_SMOOTHING_DISABLED,IMAGE_SMOOTHING_ENABLED}from"./common.js";import{assign}from"../../obj.js";import{compose as composeTransform,makeInverse}from"../../transform.js";import{containsExtent,intersects as intersectsExtent}from"../../extent.js";import{fromUserExtent}from"../../proj.js";import{getIntersection,isEmpty}from"../../extent.js";import{toString as toTransformString}from"../../transform.js";var CanvasImageLayerRenderer=function(t){function e(e){var r=t.call(this,e)||this;return r.image_=null,r}return __extends(e,t),e.prototype.getImage=function(){return this.image_?this.image_.getImage():null},e.prototype.prepareFrame=function(t){var e=t.layerStatesArray[t.layerIndex],r=t.pixelRatio,n=t.viewState,o=n.resolution,i=this.getLayer().getSource(),a=t.viewHints,s=t.extent;if(void 0!==e.extent&&(s=getIntersection(s,fromUserExtent(e.extent,n.projection))),!a[ViewHint.ANIMATING]&&!a[ViewHint.INTERACTING]&&!isEmpty(s))if(i){var m=n.projection;if(!ENABLE_RASTER_REPROJECTION){var p=i.getProjection();p&&(m=p)}var c=i.getImage(s,o,r,m);c&&this.loadImage(c)&&(this.image_=c)}else this.image_=null;return!!this.image_},e.prototype.renderFrame=function(t,e){var r=this.image_,n=r.getExtent(),o=r.getResolution(),i=r.getPixelRatio(),a=t.layerStatesArray[t.layerIndex],s=t.pixelRatio,m=t.viewState,p=m.center,c=m.resolution,h=t.size,f=s*o/(c*i),l=Math.round(h[0]*s),g=Math.round(h[1]*s),u=m.rotation;if(u){var d=Math.round(Math.sqrt(l*l+g*g));l=d,g=d}composeTransform(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/s,1/s,u,-l/2,-g/2),makeInverse(this.inversePixelTransform,this.pixelTransform);var _=toTransformString(this.pixelTransform);this.useContainer(e,_,a.opacity,this.getBackground(t));var v=this.context,x=v.canvas;x.width!=l||x.height!=g?(x.width=l,x.height=g):this.containerReused||v.clearRect(0,0,l,g);var E=!1,y=!0;if(a.extent){var I=fromUserExtent(a.extent,m.projection);(E=(y=intersectsExtent(I,t.extent))&&!containsExtent(I,t.extent))&&this.clipUnrotated(v,t,I)}var R=r.getImage(),T=composeTransform(this.tempTransform,l/2,g/2,f,f,0,i*(n[0]-p[0])/o,i*(p[1]-n[3])/o);this.renderedResolution=o*s/i;var A=R.width*T[0],j=R.height*T[3];if(this.getLayer().getSource().getInterpolate()||assign(v,IMAGE_SMOOTHING_DISABLED),this.preRender(v,t),y&&A>=.5&&j>=.5){var S=T[4],M=T[5],O=a.opacity,w=void 0;1!==O&&(w=v.globalAlpha,v.globalAlpha=O),v.drawImage(R,0,0,+R.width,+R.height,Math.round(S),Math.round(M),Math.round(A),Math.round(j)),1!==O&&(v.globalAlpha=w)}return this.postRender(v,t),E&&v.restore(),assign(v,IMAGE_SMOOTHING_ENABLED),_!==x.style.transform&&(x.style.transform=_),this.container},e}(CanvasLayerRenderer);export default CanvasImageLayerRenderer;
//# sourceMappingURL=/sm/16921d581a65f446d931a8c8c21357b3d84bde6bbb41fa9b9dd64b0f75769a52.map