/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/renderer/canvas/Layer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();import LayerRenderer from"../Layer.js";import RenderEvent from"../../render/Event.js";import RenderEventType from"../../render/EventType.js";import{apply as applyTransform,compose as composeTransform,create as createTransform}from"../../transform.js";import{asArray}from"../../color.js";import{containsCoordinate,getBottomLeft,getBottomRight,getTopLeft,getTopRight}from"../../extent.js";import{createCanvasContext2D}from"../../dom.js";import{equals}from"../../array.js";var CanvasLayerRenderer=function(t){function e(e){var r=t.call(this,e)||this;return r.container=null,r.renderedResolution,r.tempTransform=createTransform(),r.pixelTransform=createTransform(),r.inversePixelTransform=createTransform(),r.context=null,r.containerReused=!1,r.pixelContext_=null,r}return __extends(e,t),e.prototype.getBackground=function(t){var e=this.getLayer().getBackground();return"function"==typeof e&&(e=e(t.viewState.resolution)),e||void 0},e.prototype.useContainer=function(t,e,r,n){var o,a,s=this.getLayer().getClassName();t&&t.className===s&&""===t.style.opacity&&1===r&&(!n||t.style.backgroundColor&&equals(asArray(t.style.backgroundColor),asArray(n)))&&((p=t.firstElementChild)instanceof HTMLCanvasElement&&(a=p.getContext("2d")));if(a&&a.canvas.style.transform===e?(this.container=t,this.context=a,this.containerReused=!0):this.containerReused&&(this.container=null,this.context=null,this.containerReused=!1),!this.container){(o=document.createElement("div")).className=s;var i=o.style;i.position="absolute",i.width="100%",i.height="100%",n&&(i.backgroundColor=n);var p=(a=createCanvasContext2D()).canvas;o.appendChild(p),(i=p.style).position="absolute",i.left="0",i.transformOrigin="top left",this.container=o,this.context=a}},e.prototype.clipUnrotated=function(t,e,r){var n=getTopLeft(r),o=getTopRight(r),a=getBottomRight(r),s=getBottomLeft(r);applyTransform(e.coordinateToPixelTransform,n),applyTransform(e.coordinateToPixelTransform,o),applyTransform(e.coordinateToPixelTransform,a),applyTransform(e.coordinateToPixelTransform,s);var i=this.inversePixelTransform;applyTransform(i,n),applyTransform(i,o),applyTransform(i,a),applyTransform(i,s),t.save(),t.beginPath(),t.moveTo(Math.round(n[0]),Math.round(n[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.lineTo(Math.round(s[0]),Math.round(s[1])),t.clip()},e.prototype.dispatchRenderEvent_=function(t,e,r){var n=this.getLayer();if(n.hasListener(t)){var o=new RenderEvent(t,this.inversePixelTransform,r,e);n.dispatchEvent(o)}},e.prototype.preRender=function(t,e){this.dispatchRenderEvent_(RenderEventType.PRERENDER,t,e)},e.prototype.postRender=function(t,e){this.dispatchRenderEvent_(RenderEventType.POSTRENDER,t,e)},e.prototype.getRenderTransform=function(t,e,r,n,o,a,s){var i=o/2,p=a/2,l=n/e,c=-l,f=-t[0]+s,m=-t[1];return composeTransform(this.tempTransform,i,p,l,c,-r,f,m)},e.prototype.getDataAtPixel=function(t,e,r){var n=applyTransform(this.inversePixelTransform,t.slice()),o=this.context,a=this.getLayer().getExtent();if(a){var s=applyTransform(e.pixelToCoordinateTransform,t.slice());if(!containsCoordinate(a,s))return null}var i,p=Math.round(n[0]),l=Math.round(n[1]),c=this.pixelContext_;if(!c){var f=document.createElement("canvas");f.width=1,f.height=1,c=f.getContext("2d"),this.pixelContext_=c}c.clearRect(0,0,1,1);try{c.drawImage(o.canvas,p,l,1,1,0,0,1,1),i=c.getImageData(0,0,1,1).data}catch(t){return"SecurityError"===t.name?(this.pixelContext_=null,new Uint8Array):i}return 0===i[3]?null:i},e}(LayerRenderer);export default CanvasLayerRenderer;
//# sourceMappingURL=/sm/87a9ecc62d0733cdc92e7a9f742f88faef2f4647da3467da8e4d6930bff9a78a.map