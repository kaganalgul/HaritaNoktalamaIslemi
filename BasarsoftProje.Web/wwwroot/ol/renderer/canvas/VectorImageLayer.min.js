/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/renderer/canvas/VectorImageLayer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();import CanvasImageLayerRenderer from"./ImageLayer.js";import CanvasVectorLayerRenderer from"./VectorLayer.js";import EventType from"../../events/EventType.js";import ImageCanvas from"../../ImageCanvas.js";import ImageState from"../../ImageState.js";import RBush from"rbush";import ViewHint from"../../ViewHint.js";import{apply,compose,create}from"../../transform.js";import{assign}from"../../obj.js";import{getHeight,getWidth,isEmpty,scaleFromCenter}from"../../extent.js";var CanvasVectorImageLayerRenderer=function(e){function t(t){var r=e.call(this,t)||this;return r.vectorRenderer_=new CanvasVectorLayerRenderer(t),r.layerImageRatio_=t.getImageRatio(),r.coordinateToVectorPixelTransform_=create(),r.renderedPixelToCoordinateTransform_=null,r}return __extends(t,e),t.prototype.disposeInternal=function(){this.vectorRenderer_.dispose(),e.prototype.disposeInternal.call(this)},t.prototype.getFeatures=function(e){if(!this.vectorRenderer_)return new Promise((function(e){return e([])}));var t=apply(this.coordinateToVectorPixelTransform_,apply(this.renderedPixelToCoordinateTransform_,e.slice()));return this.vectorRenderer_.getFeatures(t)},t.prototype.handleFontsChanged=function(){this.vectorRenderer_.handleFontsChanged()},t.prototype.prepareFrame=function(e){var t=e.pixelRatio,r=e.viewState,o=r.resolution,n=e.viewHints,a=this.vectorRenderer_,i=e.extent;1!==this.layerImageRatio_&&(i=i.slice(0),scaleFromCenter(i,this.layerImageRatio_));var s=getWidth(i)/o,c=getHeight(i)/o;if(!n[ViewHint.ANIMATING]&&!n[ViewHint.INTERACTING]&&!isEmpty(i)){a.useContainer(null,null,1);var p=a.context,l=assign({},e,{declutterTree:new RBush(9),extent:i,size:[s,c],viewState:assign({},e.viewState,{rotation:0})}),d=!0,m=new ImageCanvas(i,o,t,p.canvas,(function(e){a.prepareFrame(l)&&a.replayGroupChanged&&(a.clipping=!1,a.renderFrame(l,null)&&(a.renderDeclutter(l),d=!1),e())}));m.addEventListener(EventType.CHANGE,function(){if(m.getState()===ImageState.LOADED){this.image_=d?null:m;var e=m.getResolution(),o=m.getPixelRatio(),n=e*t/o;this.renderedResolution=n,this.coordinateToVectorPixelTransform_=compose(this.coordinateToVectorPixelTransform_,s/2,c/2,1/n,-1/n,0,-r.center[0],-r.center[1])}}.bind(this)),m.load()}return this.image_&&(this.renderedPixelToCoordinateTransform_=e.pixelToCoordinateTransform.slice()),!!this.image_},t.prototype.preRender=function(){},t.prototype.postRender=function(){},t.prototype.renderDeclutter=function(){},t.prototype.forEachFeatureAtCoordinate=function(t,r,o,n,a){return this.vectorRenderer_?this.vectorRenderer_.forEachFeatureAtCoordinate(t,r,o,n,a):e.prototype.forEachFeatureAtCoordinate.call(this,t,r,o,n,a)},t}(CanvasImageLayerRenderer);export default CanvasVectorImageLayerRenderer;
//# sourceMappingURL=/sm/86696398d392bb41cfeee4fb952686356484271dee0adf85d249a9a4956a62a3.map