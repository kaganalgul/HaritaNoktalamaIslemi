/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/interaction/DragAndDrop.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();import Event from"../events/Event.js";import EventType from"../events/EventType.js";import FormatType from"../format/FormatType.js";import Interaction from"./Interaction.js";import{TRUE}from"../functions.js";import{get as getProjection}from"../proj.js";import{listen,unlistenByKey}from"../events.js";var DragAndDropEventType={ADD_FEATURES:"addfeatures"},DragAndDropEvent=function(t){function e(e,r,n,o){var s=t.call(this,e)||this;return s.features=n,s.file=r,s.projection=o,s}return __extends(e,t),e}(Event);export{DragAndDropEvent};var DragAndDrop=function(t){function e(e){var r=this,n=e||{};(r=t.call(this,{handleEvent:TRUE})||this).on,r.once,r.un,r.readAsBuffer_=!1,r.formats_=[];for(var o=n.formatConstructors?n.formatConstructors:[],s=0,i=o.length;s<i;++s){var a=o[s];"function"==typeof a&&(a=new a),r.formats_.push(a),r.readAsBuffer_=r.readAsBuffer_||a.getType()===FormatType.ARRAY_BUFFER}return r.projection_=n.projection?getProjection(n.projection):null,r.dropListenKeys_=null,r.source_=n.source||null,r.target=n.target?n.target:null,r}return __extends(e,t),e.prototype.handleResult_=function(t,e){var r,n=e.target.result,o=this.getMap(),s=this.projection_;s||(s=o.getView().getProjection());for(var i=this.formats_,a=0,p=i.length;a<p;++a){var u=i[a],c=n;this.readAsBuffer_&&u.getType()!==FormatType.ARRAY_BUFFER&&(void 0===r&&(r=(new TextDecoder).decode(n)),c=r);var f=this.tryReadFeatures_(u,c,{featureProjection:s});if(f&&f.length>0){this.source_&&(this.source_.clear(),this.source_.addFeatures(f)),this.dispatchEvent(new DragAndDropEvent(DragAndDropEventType.ADD_FEATURES,t,f,s));break}}},e.prototype.registerListeners_=function(){var t=this.getMap();if(t){var e=this.target?this.target:t.getViewport();this.dropListenKeys_=[listen(e,EventType.DROP,this.handleDrop,this),listen(e,EventType.DRAGENTER,this.handleStop,this),listen(e,EventType.DRAGOVER,this.handleStop,this),listen(e,EventType.DROP,this.handleStop,this)]}},e.prototype.setActive=function(e){!this.getActive()&&e&&this.registerListeners_(),this.getActive()&&!e&&this.unregisterListeners_(),t.prototype.setActive.call(this,e)},e.prototype.setMap=function(e){this.unregisterListeners_(),t.prototype.setMap.call(this,e),this.getActive()&&this.registerListeners_()},e.prototype.tryReadFeatures_=function(t,e,r){try{return t.readFeatures(e,r)}catch(t){return null}},e.prototype.unregisterListeners_=function(){this.dropListenKeys_&&(this.dropListenKeys_.forEach(unlistenByKey),this.dropListenKeys_=null)},e.prototype.handleDrop=function(t){for(var e=t.dataTransfer.files,r=0,n=e.length;r<n;++r){var o=e.item(r),s=new FileReader;s.addEventListener(EventType.LOAD,this.handleResult_.bind(this,o)),this.readAsBuffer_?s.readAsArrayBuffer(o):s.readAsText(o)}},e.prototype.handleStop=function(t){t.stopPropagation(),t.preventDefault(),t.dataTransfer.dropEffect="copy"},e}(Interaction);export default DragAndDrop;
//# sourceMappingURL=/sm/e6c3d35824eaf1f0bc2aae0e457239194390ac3079cb0f427c481eab337910e2.map