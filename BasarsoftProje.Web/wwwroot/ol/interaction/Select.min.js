/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/interaction/Select.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();import Collection from"../Collection.js";import CollectionEventType from"../CollectionEventType.js";import Event from"../events/Event.js";import GeometryType from"../geom/GeometryType.js";import Interaction from"./Interaction.js";import VectorLayer from"../layer/Vector.js";import{TRUE}from"../functions.js";import{clear}from"../obj.js";import{createEditingStyle}from"../style/Style.js";import{extend,includes}from"../array.js";import{getUid}from"../util.js";import{never,shiftKeyOnly,singleClick}from"../events/condition.js";var SelectEventType={SELECT:"select"},SelectEvent=function(e){function t(t,r,i,o){var n=e.call(this,t)||this;return n.selected=r,n.deselected=i,n.mapBrowserEvent=o,n}return __extends(t,e),t}(Event);export{SelectEvent};var originalFeatureStyles={},Select=function(e){function t(t){var r=e.call(this)||this;r.on,r.once,r.un;var i,o=t||{};if(r.boundAddFeature_=r.addFeature_.bind(r),r.boundRemoveFeature_=r.removeFeature_.bind(r),r.condition_=o.condition?o.condition:singleClick,r.addCondition_=o.addCondition?o.addCondition:never,r.removeCondition_=o.removeCondition?o.removeCondition:never,r.toggleCondition_=o.toggleCondition?o.toggleCondition:shiftKeyOnly,r.multi_=!!o.multi&&o.multi,r.filter_=o.filter?o.filter:TRUE,r.hitTolerance_=o.hitTolerance?o.hitTolerance:0,r.style_=void 0!==o.style?o.style:getDefaultStyleFunction(),r.features_=o.features||new Collection,o.layers)if("function"==typeof o.layers)i=o.layers;else{var n=o.layers;i=function(e){return includes(n,e)}}else i=TRUE;return r.layerFilter_=i,r.featureLayerAssociation_={},r}return __extends(t,e),t.prototype.addFeatureLayerAssociation_=function(e,t){this.featureLayerAssociation_[getUid(e)]=t},t.prototype.getFeatures=function(){return this.features_},t.prototype.getHitTolerance=function(){return this.hitTolerance_},t.prototype.getLayer=function(e){return this.featureLayerAssociation_[getUid(e)]},t.prototype.setHitTolerance=function(e){this.hitTolerance_=e},t.prototype.setMap=function(t){this.getMap()&&this.style_&&this.features_.forEach(this.restorePreviousStyle_.bind(this)),e.prototype.setMap.call(this,t),t?(this.features_.addEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.addEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_),this.style_&&this.features_.forEach(this.applySelectedStyle_.bind(this))):(this.features_.removeEventListener(CollectionEventType.ADD,this.boundAddFeature_),this.features_.removeEventListener(CollectionEventType.REMOVE,this.boundRemoveFeature_))},t.prototype.addFeature_=function(e){var t=e.element;if(this.style_&&this.applySelectedStyle_(t),!this.getLayer(t)){var r=this.getMap().getAllLayers().find((function(e){if(e instanceof VectorLayer&&e.getSource()&&e.getSource().hasFeature(t))return e}));r&&this.addFeatureLayerAssociation_(t,r)}},t.prototype.removeFeature_=function(e){var t=e.element;this.style_&&this.restorePreviousStyle_(t)},t.prototype.getStyle=function(){return this.style_},t.prototype.applySelectedStyle_=function(e){var t=getUid(e);t in originalFeatureStyles||(originalFeatureStyles[t]=e.getStyle()),e.setStyle(this.style_)},t.prototype.restorePreviousStyle_=function(e){for(var r=this.getMap().getInteractions().getArray(),i=r.length-1;i>=0;--i){var o=r[i];if(o!==this&&o instanceof t&&o.getStyle()&&-1!==o.getFeatures().getArray().lastIndexOf(e))return void e.setStyle(o.getStyle())}var n=getUid(e);e.setStyle(originalFeatureStyles[n]),delete originalFeatureStyles[n]},t.prototype.removeFeatureLayerAssociation_=function(e){delete this.featureLayerAssociation_[getUid(e)]},t.prototype.handleEvent=function(e){if(!this.condition_(e))return!0;var t=this.addCondition_(e),r=this.removeCondition_(e),i=this.toggleCondition_(e),o=!t&&!r&&!i,n=e.map,s=this.getFeatures(),a=[],l=[];if(o){clear(this.featureLayerAssociation_),n.forEachFeatureAtPixel(e.pixel,function(e,t){if(this.filter_(e,t))return this.addFeatureLayerAssociation_(e,t),l.push(e),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var u=s.getLength()-1;u>=0;--u){var c=s.item(u),y=l.indexOf(c);y>-1?l.splice(y,1):(s.remove(c),a.push(c))}0!==l.length&&s.extend(l)}else{n.forEachFeatureAtPixel(e.pixel,function(e,o){if(this.filter_(e,o))return!t&&!i||includes(s.getArray(),e)?(r||i)&&includes(s.getArray(),e)&&(a.push(e),this.removeFeatureLayerAssociation_(e)):(this.addFeatureLayerAssociation_(e,o),l.push(e)),!this.multi_}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_});for(var d=a.length-1;d>=0;--d)s.remove(a[d]);s.extend(l)}return(l.length>0||a.length>0)&&this.dispatchEvent(new SelectEvent(SelectEventType.SELECT,l,a,e)),!0},t}(Interaction);function getDefaultStyleFunction(){var e=createEditingStyle();return extend(e[GeometryType.POLYGON],e[GeometryType.LINE_STRING]),extend(e[GeometryType.GEOMETRY_COLLECTION],e[GeometryType.LINE_STRING]),function(t){return t.getGeometry()?e[t.getGeometry().getType()]:null}}export default Select;
//# sourceMappingURL=/sm/98b5c3d16f1f4424240eed8c6bb0c30a8ba996c9c26751174a232074b9e813b9.map