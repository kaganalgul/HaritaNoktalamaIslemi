/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/format/IGC.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Feature from"../Feature.js";import GeometryLayout from"../geom/GeometryLayout.js";import LineString from"../geom/LineString.js";import TextFeature from"./TextFeature.js";import{get as getProjection}from"../proj.js";import{transformGeometryWithOptions}from"./Feature.js";const IGCZ={BAROMETRIC:"barometric",GPS:"gps",NONE:"none"},B_RECORD_RE=/^B(\d{2})(\d{2})(\d{2})(\d{2})(\d{5})([NS])(\d{3})(\d{5})([EW])([AV])(\d{5})(\d{5})/,H_RECORD_RE=/^H.([A-Z]{3}).*?:(.*)/,HFDTE_RECORD_RE=/^HFDTE(\d{2})(\d{2})(\d{2})/,NEWLINE_RE=/\r\n|\r|\n/;class IGC extends TextFeature{constructor(e){super();const t=e||{};this.dataProjection=getProjection("EPSG:4326"),this.altitudeMode_=t.altitudeMode?t.altitudeMode:IGCZ.NONE}readFeatureFromText(e,t){const r=this.altitudeMode_,o=e.split(NEWLINE_RE),s={},n=[];let a,i,p=2e3,E=0,u=1,m=-1;for(a=0,i=o.length;a<i;++a){const e=o[a];let t;if("B"==e.charAt(0)){if(t=B_RECORD_RE.exec(e),t){const e=parseInt(t[1],10),o=parseInt(t[2],10),s=parseInt(t[3],10);let a=parseInt(t[4],10)+parseInt(t[5],10)/6e4;"S"==t[6]&&(a=-a);let i=parseInt(t[7],10)+parseInt(t[8],10)/6e4;if("W"==t[9]&&(i=-i),n.push(i,a),r!=IGCZ.NONE){let e;e=r==IGCZ.GPS?parseInt(t[11],10):r==IGCZ.BAROMETRIC?parseInt(t[12],10):0,n.push(e)}let d=Date.UTC(p,E,u,e,o,s);d<m&&(d=Date.UTC(p,E,u+1,e,o,s)),n.push(d/1e3),m=d}}else"H"==e.charAt(0)&&(t=HFDTE_RECORD_RE.exec(e),t?(u=parseInt(t[1],10),E=parseInt(t[2],10)-1,p=2e3+parseInt(t[3],10)):(t=H_RECORD_RE.exec(e),t&&(s[t[1]]=t[2].trim())))}if(0===n.length)return null;const d=r==IGCZ.NONE?GeometryLayout.XYM:GeometryLayout.XYZM,I=new LineString(n,d),R=new Feature(transformGeometryWithOptions(I,!1,t));return R.setProperties(s,!0),R}readFeaturesFromText(e,t){const r=this.readFeatureFromText(e,t);return r?[r]:[]}}export default IGC;
//# sourceMappingURL=/sm/1581c86210c590b7c01efe2e98960e2e7c969c61254696e5d9d321755d19014e.map