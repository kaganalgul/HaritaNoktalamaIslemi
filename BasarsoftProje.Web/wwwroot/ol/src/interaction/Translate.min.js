/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/interaction/Translate.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import Collection from"../Collection.js";import Event from"../events/Event.js";import InteractionProperty from"./Property.js";import PointerInteraction from"./Pointer.js";import{TRUE}from"../functions.js";import{always}from"../events/condition.js";import{includes}from"../array.js";const TranslateEventType={TRANSLATESTART:"translatestart",TRANSLATING:"translating",TRANSLATEEND:"translateend"};export class TranslateEvent extends Event{constructor(t,e,s,i,a){super(t),this.features=e,this.coordinate=s,this.startCoordinate=i,this.mapBrowserEvent=a}}class Translate extends PointerInteraction{constructor(t){const e=t||{};let s;if(super(e),this.on,this.once,this.un,this.lastCoordinate_=null,this.startCoordinate_=null,this.features_=void 0!==e.features?e.features:null,e.layers&&!this.features_)if("function"==typeof e.layers)s=e.layers;else{const t=e.layers;s=function(e){return includes(t,e)}}else s=TRUE;this.layerFilter_=s,this.filter_=e.filter&&!this.features_?e.filter:TRUE,this.hitTolerance_=e.hitTolerance?e.hitTolerance:0,this.condition_=e.condition?e.condition:always,this.lastFeature_=null,this.addChangeListener(InteractionProperty.ACTIVE,this.handleActiveChanged_)}handleDownEvent(t){if(!t.originalEvent||!this.condition_(t))return!1;if(this.lastFeature_=this.featuresAtPixel_(t.pixel,t.map),!this.lastCoordinate_&&this.lastFeature_){this.startCoordinate_=t.coordinate,this.lastCoordinate_=t.coordinate,this.handleMoveEvent(t);const e=this.features_||new Collection([this.lastFeature_]);return this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATESTART,e,t.coordinate,this.startCoordinate_,t)),!0}return!1}handleUpEvent(t){if(this.lastCoordinate_){this.lastCoordinate_=null,this.handleMoveEvent(t);const e=this.features_||new Collection([this.lastFeature_]);return this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATEEND,e,t.coordinate,this.startCoordinate_,t)),this.startCoordinate_=null,!0}return!1}handleDragEvent(t){if(this.lastCoordinate_){const e=t.coordinate,s=e[0]-this.lastCoordinate_[0],i=e[1]-this.lastCoordinate_[1],a=this.features_||new Collection([this.lastFeature_]);a.forEach((function(t){const e=t.getGeometry();e.translate(s,i),t.setGeometry(e)})),this.lastCoordinate_=e,this.dispatchEvent(new TranslateEvent(TranslateEventType.TRANSLATING,a,e,this.startCoordinate_,t))}}handleMoveEvent(t){const e=t.map.getViewport();this.featuresAtPixel_(t.pixel,t.map)?(e.classList.remove(this.lastCoordinate_?"ol-grab":"ol-grabbing"),e.classList.add(this.lastCoordinate_?"ol-grabbing":"ol-grab")):e.classList.remove("ol-grab","ol-grabbing")}featuresAtPixel_(t,e){return e.forEachFeatureAtPixel(t,function(t,e){if(this.filter_(t,e)&&(!this.features_||includes(this.features_.getArray(),t)))return t}.bind(this),{layerFilter:this.layerFilter_,hitTolerance:this.hitTolerance_})}getHitTolerance(){return this.hitTolerance_}setHitTolerance(t){this.hitTolerance_=t}setMap(t){const e=this.getMap();super.setMap(t),this.updateState_(e)}handleActiveChanged_(){this.updateState_(null)}updateState_(t){let e=this.getMap();const s=this.getActive();if((!e||!s)&&(e=e||t,e)){e.getViewport().classList.remove("ol-grab","ol-grabbing")}}}export default Translate;
//# sourceMappingURL=/sm/9dedca5ecf34232d01972145fdc0a3a51b83af3ea1fe6d3a9dbb84b2522601de.map