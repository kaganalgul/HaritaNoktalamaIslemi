/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/Image.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import EventType from"./events/EventType.js";import ImageBase from"./ImageBase.js";import ImageState from"./ImageState.js";import{IMAGE_DECODE}from"./has.js";import{getHeight}from"./extent.js";import{listenOnce,unlistenByKey}from"./events.js";class ImageWrapper extends ImageBase{constructor(t,e,i,s,n,a){super(t,e,i,ImageState.IDLE),this.src_=s,this.image_=new Image,null!==n&&(this.image_.crossOrigin=n),this.unlisten_=null,this.state=ImageState.IDLE,this.imageLoadFunction_=a}getImage(){return this.image_}handleImageError_(){this.state=ImageState.ERROR,this.unlistenImage_(),this.changed()}handleImageLoad_(){void 0===this.resolution&&(this.resolution=getHeight(this.extent)/this.image_.height),this.state=ImageState.LOADED,this.unlistenImage_(),this.changed()}load(){this.state!=ImageState.IDLE&&this.state!=ImageState.ERROR||(this.state=ImageState.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}setImage(t){this.image_=t,this.resolution=getHeight(this.extent)/this.image_.height}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}}export function listenImage(t,e,i){const s=t;let n=!0,a=!1,h=!1;const g=[listenOnce(s,EventType.LOAD,(function(){h=!0,a||e()}))];return s.src&&IMAGE_DECODE?(a=!0,s.decode().then((function(){n&&e()})).catch((function(t){n&&(h?e():i())}))):g.push(listenOnce(s,EventType.ERROR,i)),function(){n=!1,g.forEach(unlistenByKey)}}export default ImageWrapper;
//# sourceMappingURL=/sm/90d5e173d88b3fb251c1023c2f6cdc4336e8f65b04381772efde681cec6b739a.map