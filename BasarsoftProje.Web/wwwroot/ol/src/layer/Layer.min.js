/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/layer/Layer.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import BaseLayer from"./Base.js";import EventType from"../events/EventType.js";import LayerProperty from"./Property.js";import RenderEventType from"../render/EventType.js";import SourceState from"../source/State.js";import{assert}from"../asserts.js";import{assign}from"../obj.js";import{listen,unlistenByKey}from"../events.js";class Layer extends BaseLayer{constructor(e){const r=assign({},e);delete r.source,super(r),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,e.render&&(this.render=e.render),e.map&&this.setMap(e.map),this.addChangeListener(LayerProperty.SOURCE,this.handleSourcePropertyChange_);const t=e.source?e.source:null;this.setSource(t)}getLayersArray(e){const r=e||[];return r.push(this),r}getLayerStatesArray(e){const r=e||[];return r.push(this.getLayerState()),r}getSource(){return this.get(LayerProperty.SOURCE)||null}getSourceState(){const e=this.getSource();return e?e.getState():SourceState.UNDEFINED}handleSourceChange_(){this.changed()}handleSourcePropertyChange_(){this.sourceChangeKey_&&(unlistenByKey(this.sourceChangeKey_),this.sourceChangeKey_=null);const e=this.getSource();e&&(this.sourceChangeKey_=listen(e,EventType.CHANGE,this.handleSourceChange_,this)),this.changed()}getFeatures(e){return this.renderer_?this.renderer_.getFeatures(e):new Promise((e=>e([])))}render(e,r){const t=this.getRenderer();if(t.prepareFrame(e))return t.renderFrame(e,r)}setMapInternal(e){this.set(LayerProperty.MAP,e)}getMapInternal(){return this.get(LayerProperty.MAP)}setMap(e){this.mapPrecomposeKey_&&(unlistenByKey(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),e||this.changed(),this.mapRenderKey_&&(unlistenByKey(this.mapRenderKey_),this.mapRenderKey_=null),e&&(this.mapPrecomposeKey_=listen(e,RenderEventType.PRECOMPOSE,(function(e){const r=e.frameState.layerStatesArray,t=this.getLayerState(!1);assert(!r.some((function(e){return e.layer===t.layer})),67),r.push(t)}),this),this.mapRenderKey_=listen(this,EventType.CHANGE,e.render,e),this.changed())}setSource(e){this.set(LayerProperty.SOURCE,e)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}disposeInternal(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_),this.setSource(null),super.disposeInternal()}}export function inView(e,r){if(!e.visible)return!1;const t=r.resolution;if(t<e.minResolution||t>=e.maxResolution)return!1;const s=r.zoom;return s>e.minZoom&&s<=e.maxZoom}export default Layer;
//# sourceMappingURL=/sm/faf147db6e45c2d407e87c014d43184b599ea70cb9dacb1acced8b1861b995a6.map