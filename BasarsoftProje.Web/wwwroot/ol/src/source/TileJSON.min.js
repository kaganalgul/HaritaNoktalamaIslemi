/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/source/TileJSON.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import SourceState from"./State.js";import TileImage from"./TileImage.js";import{applyTransform,intersects}from"../extent.js";import{assert}from"../asserts.js";import{createFromTemplates}from"../tileurlfunction.js";import{createXYZ,extentFromProjection}from"../tilegrid.js";import{get as getProjection,getTransformFromProjections}from"../proj.js";import{jsonp as requestJSONP}from"../net.js";class TileJSON extends TileImage{constructor(t){let e=void 0===t.imageSmoothing||t.imageSmoothing;if(void 0!==t.interpolate&&(e=t.interpolate),super({attributions:t.attributions,cacheSize:t.cacheSize,crossOrigin:t.crossOrigin,interpolate:e,projection:getProjection("EPSG:3857"),reprojectionErrorThreshold:t.reprojectionErrorThreshold,state:SourceState.LOADING,tileLoadFunction:t.tileLoadFunction,wrapX:void 0===t.wrapX||t.wrapX,transition:t.transition,zDirection:t.zDirection}),this.tileJSON_=null,this.tileSize_=t.tileSize,t.url)if(t.jsonp)requestJSONP(t.url,this.handleTileJSONResponse.bind(this),this.handleTileJSONError.bind(this));else{const e=new XMLHttpRequest;e.addEventListener("load",this.onXHRLoad_.bind(this)),e.addEventListener("error",this.onXHRError_.bind(this)),e.open("GET",t.url),e.send()}else t.tileJSON?this.handleTileJSONResponse(t.tileJSON):assert(!1,51)}onXHRLoad_(t){const e=t.target;if(!e.status||e.status>=200&&e.status<300){let t;try{t=JSON.parse(e.responseText)}catch(t){return void this.handleTileJSONError()}this.handleTileJSONResponse(t)}else this.handleTileJSONError()}onXHRError_(t){this.handleTileJSONError()}getTileJSON(){return this.tileJSON_}handleTileJSONResponse(t){const e=getProjection("EPSG:4326"),i=this.getProjection();let r;if(void 0!==t.bounds){const o=getTransformFromProjections(e,i);r=applyTransform(t.bounds,o)}const o=extentFromProjection(i),s=t.minzoom||0,n=t.maxzoom||22,a=createXYZ({extent:o,maxZoom:n,minZoom:s,tileSize:this.tileSize_});if(this.tileGrid=a,this.tileUrlFunction=createFromTemplates(t.tiles,a),void 0!==t.attribution&&!this.getAttributions()){const e=void 0!==r?r:o;this.setAttributions((function(i){return intersects(e,i.extent)?[t.attribution]:null}))}this.tileJSON_=t,this.setState(SourceState.READY)}handleTileJSONError(){this.setState(SourceState.ERROR)}}export default TileJSON;
//# sourceMappingURL=/sm/4b8a4286b069500dd0a6bd52e4838a7bb8356b1cc091a741b0f3548c13d21be9.map