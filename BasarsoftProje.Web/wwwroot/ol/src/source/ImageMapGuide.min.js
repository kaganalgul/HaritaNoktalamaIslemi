/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/source/ImageMapGuide.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import EventType from"../events/EventType.js";import ImageSource,{defaultImageLoadFunction}from"./Image.js";import ImageWrapper from"../Image.js";import{appendParams}from"../uri.js";import{assign}from"../obj.js";import{containsExtent,getCenter,getHeight,getWidth,scaleFromCenter}from"../extent.js";class ImageMapGuide extends ImageSource{constructor(e){let i=void 0===e.imageSmoothing||e.imageSmoothing;void 0!==e.interpolate&&(i=e.interpolate),super({interpolate:i,projection:e.projection,resolutions:e.resolutions}),this.crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,this.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,this.params_=e.params||{},this.url_=e.url,this.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:defaultImageLoadFunction,this.hidpi_=void 0===e.hidpi||e.hidpi,this.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,this.ratio_=void 0!==e.ratio?e.ratio:1,this.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,this.image_=null,this.renderedRevision_=0}getParams(){return this.params_}getImageInternal(e,i,t,s){i=this.findNearestResolution(i),t=this.hidpi_?t:1;let a=this.image_;if(a&&this.renderedRevision_==this.getRevision()&&a.getResolution()==i&&a.getPixelRatio()==t&&containsExtent(a.getExtent(),e))return a;1!=this.ratio_&&(e=e.slice(),scaleFromCenter(e,this.ratio_));const r=[getWidth(e)/i*t,getHeight(e)/i*t];if(void 0!==this.url_){const n=this.getUrl(this.url_,this.params_,e,r,s);a=new ImageWrapper(e,i,t,n,this.crossOrigin_,this.imageLoadFunction_),a.addEventListener(EventType.CHANGE,this.handleImageChange.bind(this))}else a=null;return this.image_=a,this.renderedRevision_=this.getRevision(),a}getImageLoadFunction(){return this.imageLoadFunction_}updateParams(e){assign(this.params_,e),this.changed()}getUrl(e,i,t,s,a){const r=getScale(t,s,this.metersPerUnit_,this.displayDpi_),n=getCenter(t),o={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(s[0]),SETDISPLAYHEIGHT:Math.round(s[1]),SETVIEWSCALE:r,SETVIEWCENTERX:n[0],SETVIEWCENTERY:n[1]};return assign(o,i),appendParams(e,o)}setImageLoadFunction(e){this.image_=null,this.imageLoadFunction_=e,this.changed()}}function getScale(e,i,t,s){const a=getWidth(e),r=getHeight(e),n=i[0],o=i[1],g=.0254/s;return o*a>n*r?a*t/(n*g):r*t/(o*g)}export default ImageMapGuide;
//# sourceMappingURL=/sm/c8d5396c06968a0aa6effff3550e78b3b166de736b226ec34b642fd3279a1bbe.map