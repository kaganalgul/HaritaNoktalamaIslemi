/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/src/Overlay.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import BaseObject from"./Object.js";import MapEventType from"./MapEventType.js";import OverlayPositioning from"./OverlayPositioning.js";import{CLASS_SELECTABLE}from"./css.js";import{containsExtent}from"./extent.js";import{listen,unlistenByKey}from"./events.js";import{outerHeight,outerWidth,removeChildren,removeNode}from"./dom.js";const Property={ELEMENT:"element",MAP:"map",OFFSET:"offset",POSITION:"position",POSITIONING:"positioning"};class Overlay extends BaseObject{constructor(t){super(),this.on,this.once,this.un,this.options=t,this.id=t.id,this.insertFirst=void 0===t.insertFirst||t.insertFirst,this.stopEvent=void 0===t.stopEvent||t.stopEvent,this.element=document.createElement("div"),this.element.className=void 0!==t.className?t.className:"ol-overlay-container "+CLASS_SELECTABLE,this.element.style.position="absolute",this.element.style.pointerEvents="auto";let e=t.autoPan;e&&"object"!=typeof e&&(e={animation:t.autoPanAnimation,margin:t.autoPanMargin}),this.autoPan=e||!1,this.rendered={transform_:"",visible:!0},this.mapPostrenderListenerKey=null,this.addChangeListener(Property.ELEMENT,this.handleElementChanged),this.addChangeListener(Property.MAP,this.handleMapChanged),this.addChangeListener(Property.OFFSET,this.handleOffsetChanged),this.addChangeListener(Property.POSITION,this.handlePositionChanged),this.addChangeListener(Property.POSITIONING,this.handlePositioningChanged),void 0!==t.element&&this.setElement(t.element),this.setOffset(void 0!==t.offset?t.offset:[0,0]),this.setPositioning(void 0!==t.positioning?t.positioning:OverlayPositioning.TOP_LEFT),void 0!==t.position&&this.setPosition(t.position)}getElement(){return this.get(Property.ELEMENT)}getId(){return this.id}getMap(){return this.get(Property.MAP)}getOffset(){return this.get(Property.OFFSET)}getPosition(){return this.get(Property.POSITION)}getPositioning(){return this.get(Property.POSITIONING)}handleElementChanged(){removeChildren(this.element);const t=this.getElement();t&&this.element.appendChild(t)}handleMapChanged(){this.mapPostrenderListenerKey&&(removeNode(this.element),unlistenByKey(this.mapPostrenderListenerKey),this.mapPostrenderListenerKey=null);const t=this.getMap();if(t){this.mapPostrenderListenerKey=listen(t,MapEventType.POSTRENDER,this.render,this),this.updatePixelPosition();const e=this.stopEvent?t.getOverlayContainerStopEvent():t.getOverlayContainer();this.insertFirst?e.insertBefore(this.element,e.childNodes[0]||null):e.appendChild(this.element),this.performAutoPan()}}render(){this.updatePixelPosition()}handleOffsetChanged(){this.updatePixelPosition()}handlePositionChanged(){this.updatePixelPosition(),this.performAutoPan()}handlePositioningChanged(){this.updatePixelPosition()}setElement(t){this.set(Property.ELEMENT,t)}setMap(t){this.set(Property.MAP,t)}setOffset(t){this.set(Property.OFFSET,t)}setPosition(t){this.set(Property.POSITION,t)}performAutoPan(){this.autoPan&&this.panIntoView(this.autoPan)}panIntoView(t){const e=this.getMap();if(!e||!e.getTargetElement()||!this.get(Property.POSITION))return;const i=this.getRect(e.getTargetElement(),e.getSize()),n=this.getElement(),s=this.getRect(n,[outerWidth(n),outerHeight(n)]),o=t||{},r=void 0===o.margin?20:o.margin;if(!containsExtent(i,s)){const t=s[0]-i[0],n=i[2]-s[2],a=s[1]-i[1],h=i[3]-s[3],l=[0,0];if(t<0?l[0]=t-r:n<0&&(l[0]=Math.abs(n)+r),a<0?l[1]=a-r:h<0&&(l[1]=Math.abs(h)+r),0!==l[0]||0!==l[1]){const t=e.getView().getCenterInternal(),i=e.getPixelFromCoordinateInternal(t);if(!i)return;const n=[i[0]+l[0],i[1]+l[1]],s=o.animation||{};e.getView().animateInternal({center:e.getCoordinateFromPixelInternal(n),duration:s.duration,easing:s.easing})}}}getRect(t,e){const i=t.getBoundingClientRect(),n=i.left+window.pageXOffset,s=i.top+window.pageYOffset;return[n,s,n+e[0],s+e[1]]}setPositioning(t){this.set(Property.POSITIONING,t)}setVisible(t){this.rendered.visible!==t&&(this.element.style.display=t?"":"none",this.rendered.visible=t)}updatePixelPosition(){const t=this.getMap(),e=this.getPosition();if(!t||!t.isRendered()||!e)return void this.setVisible(!1);const i=t.getPixelFromCoordinate(e),n=t.getSize();this.updateRenderedPosition(i,n)}updateRenderedPosition(t,e){const i=this.element.style,n=this.getOffset(),s=this.getPositioning();this.setVisible(!0);const o=Math.round(t[0]+n[0])+"px",r=Math.round(t[1]+n[1])+"px";let a="0%",h="0%";s==OverlayPositioning.BOTTOM_RIGHT||s==OverlayPositioning.CENTER_RIGHT||s==OverlayPositioning.TOP_RIGHT?a="-100%":s!=OverlayPositioning.BOTTOM_CENTER&&s!=OverlayPositioning.CENTER_CENTER&&s!=OverlayPositioning.TOP_CENTER||(a="-50%"),s==OverlayPositioning.BOTTOM_LEFT||s==OverlayPositioning.BOTTOM_CENTER||s==OverlayPositioning.BOTTOM_RIGHT?h="-100%":s!=OverlayPositioning.CENTER_LEFT&&s!=OverlayPositioning.CENTER_CENTER&&s!=OverlayPositioning.CENTER_RIGHT||(h="-50%");const l=`translate(${a}, ${h}) translate(${o}, ${r})`;this.rendered.transform_!=l&&(this.rendered.transform_=l,i.transform=l,i.msTransform=l)}getOptions(){return this.options}}export default Overlay;
//# sourceMappingURL=/sm/1d0d39f655578333a3254222f2941de55065048a4850188c97879ff23b42bdaa.map