/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/render/canvas/hitdetect.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import CanvasImmediateRenderer from"./Immediate.js";import GeometryType from"../../geom/GeometryType.js";import IconAnchorUnits from"../../style/IconAnchorUnits.js";import{Icon}from"../../style.js";import{clamp}from"../../math.js";import{createCanvasContext2D}from"../../dom.js";import{intersects}from"../../extent.js";import{numberSafeCompareFunction}from"../../array.js";export var HIT_DETECT_RESOLUTION=.5;export function createHitDetectionImageData(e,t,r,a,o,n,i){var m=e[0]*HIT_DETECT_RESOLUTION,s=e[1]*HIT_DETECT_RESOLUTION,c=createCanvasContext2D(m,s);c.imageSmoothingEnabled=!1;for(var h=c.canvas,g=new CanvasImmediateRenderer(c,HIT_DETECT_RESOLUTION,o,null,i),l=r.length,T=Math.floor(16777215/l),f={},I=1;I<=l;++I){var p=r[I-1],v=p.getStyleFunction()||a;if(a){var y=v(p,n);if(y){Array.isArray(y)||(y=[y]);for(var E="#"+("000000"+(I*T).toString(16)).slice(-6),S=0,d=y.length;S<d;++S){var C=y[S],u=C.getGeometryFunction()(p);if(u&&intersects(o,u.getExtent())){var O=C.clone(),D=O.getFill();D&&D.setColor(E);var R=O.getStroke();R&&(R.setColor(E),R.setLineDash(null)),O.setText(void 0);var _=C.getImage();if(_&&0!==_.getOpacity()){var L=_.getImageSize();if(!L)continue;var U=createCanvasContext2D(L[0],L[1],void 0,{alpha:!1}),N=U.canvas;U.fillStyle=E,U.fillRect(0,0,N.width,N.height),O.setImage(new Icon({img:N,imgSize:L,anchor:_.getAnchor(),anchorXUnits:IconAnchorUnits.PIXELS,anchorYUnits:IconAnchorUnits.PIXELS,offset:_.getOrigin(),opacity:1,size:_.getSize(),scale:_.getScale(),rotation:_.getRotation(),rotateWithView:_.getRotateWithView()}))}var x=O.getZIndex()||0;(w=f[x])||(w={},f[x]=w,w[GeometryType.POLYGON]=[],w[GeometryType.CIRCLE]=[],w[GeometryType.LINE_STRING]=[],w[GeometryType.POINT]=[]),w[u.getType().replace("Multi","")].push(u,O)}}}}}for(var G=Object.keys(f).map(Number).sort(numberSafeCompareFunction),j=(I=0,G.length);I<j;++I){var w=f[G[I]];for(var A in w){var H=w[A];for(S=0,d=H.length;S<d;S+=2){g.setStyle(H[S+1]);for(var M=0,b=t.length;M<b;++M)g.setTransform(t[M]),g.drawGeometry(H[S])}}}return c.getImageData(0,0,h.width,h.height)}export function hitDetect(e,t,r){var a=[];if(r){var o=Math.floor(Math.round(e[0])*HIT_DETECT_RESOLUTION),n=Math.floor(Math.round(e[1])*HIT_DETECT_RESOLUTION),i=4*(clamp(o,0,r.width-1)+clamp(n,0,r.height-1)*r.width),m=r.data[i],s=r.data[i+1],c=r.data[i+2]+256*(s+256*m),h=Math.floor(16777215/t.length);c&&c%h==0&&a.push(t[c/h-1])}return a}
//# sourceMappingURL=/sm/90a0ce35a77f9b603aa551ffe6e0780462f25d348b03a329ef04022f7b742f3c.map