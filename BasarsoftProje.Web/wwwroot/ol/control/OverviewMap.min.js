/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/control/OverviewMap.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var e=function(t,o){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o])},e(t,o)};return function(t,o){if("function"!=typeof o&&null!==o)throw new TypeError("Class extends value "+String(o)+" is not a constructor or null");function i(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(i.prototype=o.prototype,new i)}}();import CompositeMapRenderer from"../renderer/Composite.js";import Control from"./Control.js";import EventType from"../events/EventType.js";import MapEventType from"../MapEventType.js";import MapProperty from"../MapProperty.js";import ObjectEventType from"../ObjectEventType.js";import Overlay from"../Overlay.js";import OverlayPositioning from"../OverlayPositioning.js";import PluggableMap from"../PluggableMap.js";import View from"../View.js";import ViewProperty from"../ViewProperty.js";import{CLASS_COLLAPSED,CLASS_CONTROL,CLASS_UNSELECTABLE}from"../css.js";import{containsExtent,equals as equalsExtent,getBottomRight,getTopLeft,scaleFromCenter}from"../extent.js";import{listen,listenOnce}from"../events.js";import{fromExtent as polygonFromExtent}from"../geom/Polygon.js";import{replaceNode}from"../dom.js";var MAX_RATIO=.75,MIN_RATIO=.1,ControlledMap=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.createRenderer=function(){return new CompositeMapRenderer(this)},t}(PluggableMap),OverviewMap=function(e){function t(t){var o=this,i=t||{};(o=e.call(this,{element:document.createElement("div"),render:i.render,target:i.target})||this).boundHandleRotationChanged_=o.handleRotationChanged_.bind(o),o.collapsed_=void 0===i.collapsed||i.collapsed,o.collapsible_=void 0===i.collapsible||i.collapsible,o.collapsible_||(o.collapsed_=!1),o.rotateWithView_=void 0!==i.rotateWithView&&i.rotateWithView,o.viewExtent_=void 0;var n=void 0!==i.className?i.className:"ol-overviewmap",a=void 0!==i.tipLabel?i.tipLabel:"Overview map",r=void 0!==i.collapseLabel?i.collapseLabel:"‹";"string"==typeof r?(o.collapseLabel_=document.createElement("span"),o.collapseLabel_.textContent=r):o.collapseLabel_=r;var l=void 0!==i.label?i.label:"›";"string"==typeof l?(o.label_=document.createElement("span"),o.label_.textContent=l):o.label_=l;var s=o.collapsible_&&!o.collapsed_?o.collapseLabel_:o.label_,p=document.createElement("button");p.setAttribute("type","button"),p.title=a,p.appendChild(s),p.addEventListener(EventType.CLICK,o.handleClick_.bind(o),!1),o.ovmapDiv_=document.createElement("div"),o.ovmapDiv_.className="ol-overviewmap-map",o.view_=i.view,o.ovmap_=new ControlledMap({view:i.view});var d=o.ovmap_;i.layers&&i.layers.forEach((function(e){d.addLayer(e)}));var _=document.createElement("div");_.className="ol-overviewmap-box",_.style.boxSizing="border-box",o.boxOverlay_=new Overlay({position:[0,0],positioning:OverlayPositioning.CENTER_CENTER,element:_}),o.ovmap_.addOverlay(o.boxOverlay_);var h=n+" "+CLASS_UNSELECTABLE+" "+CLASS_CONTROL+(o.collapsed_&&o.collapsible_?" "+CLASS_COLLAPSED:"")+(o.collapsible_?"":" ol-uncollapsible"),v=o.element;v.className=h,v.appendChild(o.ovmapDiv_),v.appendChild(p);var c=o,m=o.boxOverlay_,u=o.boxOverlay_.getElement(),g=function(e){var t,o={clientX:(t=e).clientX,clientY:t.clientY},i=d.getEventCoordinateInternal(o);m.setPosition(i)},y=function(e){var t=d.getEventCoordinateInternal(e);c.getMap().getView().setCenterInternal(t),window.removeEventListener("mousemove",g),window.removeEventListener("mouseup",y)};return u.addEventListener("mousedown",(function(){window.addEventListener("mousemove",g),window.addEventListener("mouseup",y)})),o}return __extends(t,e),t.prototype.setMap=function(t){var o=this.getMap();if(t!==o){if(o){var i=o.getView();i&&this.unbindView_(i),this.ovmap_.setTarget(null)}if(e.prototype.setMap.call(this,t),t){this.ovmap_.setTarget(this.ovmapDiv_),this.listenerKeys.push(listen(t,ObjectEventType.PROPERTYCHANGE,this.handleMapPropertyChange_,this));var n=t.getView();n&&(this.bindView_(n),n.isDef()&&(this.ovmap_.updateSize(),this.resetExtent_())),this.ovmap_.isRendered()||this.updateBoxAfterOvmapIsRendered_()}}},t.prototype.handleMapPropertyChange_=function(e){if(e.key===MapProperty.VIEW){var t=e.oldValue;t&&this.unbindView_(t);var o=this.getMap().getView();this.bindView_(o)}else this.ovmap_.isRendered()||e.key!==MapProperty.TARGET&&e.key!==MapProperty.SIZE||this.ovmap_.updateSize()},t.prototype.bindView_=function(e){if(!this.view_){var t=new View({projection:e.getProjection()});this.ovmap_.setView(t)}e.addChangeListener(ViewProperty.ROTATION,this.boundHandleRotationChanged_),this.handleRotationChanged_()},t.prototype.unbindView_=function(e){e.removeChangeListener(ViewProperty.ROTATION,this.boundHandleRotationChanged_)},t.prototype.handleRotationChanged_=function(){this.rotateWithView_&&this.ovmap_.getView().setRotation(this.getMap().getView().getRotation())},t.prototype.validateExtent_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),i=e.getView().calculateExtentInternal(o);if(!this.viewExtent_||!equalsExtent(i,this.viewExtent_)){this.viewExtent_=i;var n=t.getSize(),a=t.getView().calculateExtentInternal(n),r=t.getPixelFromCoordinateInternal(getTopLeft(i)),l=t.getPixelFromCoordinateInternal(getBottomRight(i)),s=Math.abs(r[0]-l[0]),p=Math.abs(r[1]-l[1]),d=n[0],_=n[1];s<d*MIN_RATIO||p<_*MIN_RATIO||s>d*MAX_RATIO||p>_*MAX_RATIO?this.resetExtent_():containsExtent(a,i)||this.recenter_()}}},t.prototype.resetExtent_=function(){if(0!==MAX_RATIO&&0!==MIN_RATIO){var e=this.getMap(),t=this.ovmap_,o=e.getSize(),i=e.getView().calculateExtentInternal(o),n=t.getView(),a=Math.log(MAX_RATIO/MIN_RATIO)/Math.LN2,r=1/(Math.pow(2,a/2)*MIN_RATIO);scaleFromCenter(i,r),n.fitInternal(polygonFromExtent(i))}},t.prototype.recenter_=function(){var e=this.getMap(),t=this.ovmap_,o=e.getView();t.getView().setCenterInternal(o.getCenterInternal())},t.prototype.updateBox_=function(){var e=this.getMap(),t=this.ovmap_;if(e.isRendered()&&t.isRendered()){var o=e.getSize(),i=e.getView(),n=t.getView(),a=this.rotateWithView_?0:-i.getRotation(),r=this.boxOverlay_,l=this.boxOverlay_.getElement(),s=i.getCenterInternal(),p=i.getResolution(),d=n.getResolution(),_=o[0]*p/d,h=o[1]*p/d;if(r.setPosition(s),l){l.style.width=_+"px",l.style.height=h+"px";var v="rotate("+a+"rad)";l.style.transform=v}}},t.prototype.updateBoxAfterOvmapIsRendered_=function(){this.ovmapPostrenderKey_||(this.ovmapPostrenderKey_=listenOnce(this.ovmap_,MapEventType.POSTRENDER,(function(e){delete this.ovmapPostrenderKey_,this.updateBox_()}),this))},t.prototype.handleClick_=function(e){e.preventDefault(),this.handleToggle_()},t.prototype.handleToggle_=function(){this.element.classList.toggle(CLASS_COLLAPSED),this.collapsed_?replaceNode(this.collapseLabel_,this.label_):replaceNode(this.label_,this.collapseLabel_),this.collapsed_=!this.collapsed_;var e=this.ovmap_;if(!this.collapsed_){if(e.isRendered())return this.viewExtent_=void 0,void e.render();e.updateSize(),this.resetExtent_(),this.updateBoxAfterOvmapIsRendered_()}},t.prototype.getCollapsible=function(){return this.collapsible_},t.prototype.setCollapsible=function(e){this.collapsible_!==e&&(this.collapsible_=e,this.element.classList.toggle("ol-uncollapsible"),!e&&this.collapsed_&&this.handleToggle_())},t.prototype.setCollapsed=function(e){this.collapsible_&&this.collapsed_!==e&&this.handleToggle_()},t.prototype.getCollapsed=function(){return this.collapsed_},t.prototype.getRotateWithView=function(){return this.rotateWithView_},t.prototype.setRotateWithView=function(e){this.rotateWithView_!==e&&(this.rotateWithView_=e,0!==this.getMap().getView().getRotation()&&(this.rotateWithView_?this.handleRotationChanged_():this.ovmap_.getView().setRotation(0),this.viewExtent_=void 0,this.validateExtent_(),this.updateBox_()))},t.prototype.getOverviewMap=function(){return this.ovmap_},t.prototype.render=function(e){this.validateExtent_(),this.updateBox_()},t}(Control);export default OverviewMap;
//# sourceMappingURL=/sm/056d438a4391375186c720b833c7f10bed73aea964d087f57f1740e70ff15e56.map