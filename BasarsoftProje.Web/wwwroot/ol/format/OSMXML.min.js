/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/format/OSMXML.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();import Feature from"../Feature.js";import GeometryLayout from"../geom/GeometryLayout.js";import LineString from"../geom/LineString.js";import Point from"../geom/Point.js";import Polygon from"../geom/Polygon.js";import XMLFeature from"./XMLFeature.js";import{extend}from"../array.js";import{get as getProjection}from"../proj.js";import{isEmpty}from"../obj.js";import{makeStructureNS,pushParseAndPop}from"../xml.js";import{transformGeometryWithOptions}from"./Feature.js";var NAMESPACE_URIS=[null],WAY_PARSERS=makeStructureNS(NAMESPACE_URIS,{nd:readNd,tag:readTag}),PARSERS=makeStructureNS(NAMESPACE_URIS,{node:readNode,way:readWay}),OSMXML=function(t){function e(){var e=t.call(this)||this;return e.dataProjection=getProjection("EPSG:4326"),e}return __extends(e,t),e.prototype.readFeaturesFromNode=function(t,e){var r=this.getReadOptions(t,e);if("osm"==t.localName){for(var o=pushParseAndPop({nodes:{},ways:[],features:[]},PARSERS,t,[r]),n=0;n<o.ways.length;n++){for(var a=o.ways[n],s=[],i=0,u=a.ndrefs.length;i<u;i++){var f=o.nodes[a.ndrefs[i]];extend(s,f)}var p=void 0;p=a.ndrefs[0]==a.ndrefs[a.ndrefs.length-1]?new Polygon(s,GeometryLayout.XY,[s.length]):new LineString(s,GeometryLayout.XY),transformGeometryWithOptions(p,!1,r);var d=new Feature(p);d.setId(a.id),d.setProperties(a.tags,!0),o.features.push(d)}if(o.features)return o.features}return[]},e}(XMLFeature),NODE_PARSERS=makeStructureNS(NAMESPACE_URIS,{tag:readTag});function readNode(t,e){var r=e[0],o=e[e.length-1],n=t.getAttribute("id"),a=[parseFloat(t.getAttribute("lon")),parseFloat(t.getAttribute("lat"))];o.nodes[n]=a;var s=pushParseAndPop({tags:{}},NODE_PARSERS,t,e);if(!isEmpty(s.tags)){var i=new Point(a);transformGeometryWithOptions(i,!1,r);var u=new Feature(i);u.setId(n),u.setProperties(s.tags,!0),o.features.push(u)}}function readWay(t,e){var r=t.getAttribute("id"),o=pushParseAndPop({id:r,ndrefs:[],tags:{}},WAY_PARSERS,t,e);e[e.length-1].ways.push(o)}function readNd(t,e){e[e.length-1].ndrefs.push(t.getAttribute("ref"))}function readTag(t,e){e[e.length-1].tags[t.getAttribute("k")]=t.getAttribute("v")}export default OSMXML;
//# sourceMappingURL=/sm/1d06eab8814ad488fe32da2f30a5ca278399d8fff8ec90c37387fc4a178234b4.map