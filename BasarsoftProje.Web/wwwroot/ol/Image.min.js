/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/Image.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n])},t(e,n)};return function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function i(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(i.prototype=n.prototype,new i)}}();import EventType from"./events/EventType.js";import ImageBase from"./ImageBase.js";import ImageState from"./ImageState.js";import{IMAGE_DECODE}from"./has.js";import{getHeight}from"./extent.js";import{listenOnce,unlistenByKey}from"./events.js";var ImageWrapper=function(t){function e(e,n,i,o,s,a){var r=t.call(this,e,n,i,ImageState.IDLE)||this;return r.src_=o,r.image_=new Image,null!==s&&(r.image_.crossOrigin=s),r.unlisten_=null,r.state=ImageState.IDLE,r.imageLoadFunction_=a,r}return __extends(e,t),e.prototype.getImage=function(){return this.image_},e.prototype.handleImageError_=function(){this.state=ImageState.ERROR,this.unlistenImage_(),this.changed()},e.prototype.handleImageLoad_=function(){void 0===this.resolution&&(this.resolution=getHeight(this.extent)/this.image_.height),this.state=ImageState.LOADED,this.unlistenImage_(),this.changed()},e.prototype.load=function(){this.state!=ImageState.IDLE&&this.state!=ImageState.ERROR||(this.state=ImageState.LOADING,this.changed(),this.imageLoadFunction_(this,this.src_),this.unlisten_=listenImage(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))},e.prototype.setImage=function(t){this.image_=t,this.resolution=getHeight(this.extent)/this.image_.height},e.prototype.unlistenImage_=function(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)},e}(ImageBase);export function listenImage(t,e,n){var i=t,o=!0,s=!1,a=!1,r=[listenOnce(i,EventType.LOAD,(function(){a=!0,s||e()}))];return i.src&&IMAGE_DECODE?(s=!0,i.decode().then((function(){o&&e()})).catch((function(t){o&&(a?e():n())}))):r.push(listenOnce(i,EventType.ERROR,n)),function(){o=!1,r.forEach(unlistenByKey)}}export default ImageWrapper;
//# sourceMappingURL=/sm/15dfb118967c54acc2ec50b2354492537449125510ffb2ad3b7c15a678401e0e.map