/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/Cluster.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();import EventType from"../events/EventType.js";import Feature from"../Feature.js";import GeometryType from"../geom/GeometryType.js";import Point from"../geom/Point.js";import VectorSource from"./Vector.js";import{add as addCoordinate,scale as scaleCoordinate}from"../coordinate.js";import{assert}from"../asserts.js";import{buffer,createEmpty,createOrUpdateFromCoordinate,getCenter}from"../extent.js";import{getUid}from"../util.js";var Cluster=function(t){function e(e){var r=t.call(this,{attributions:e.attributions,wrapX:e.wrapX})||this;return r.resolution=void 0,r.distance=void 0!==e.distance?e.distance:20,r.minDistance=e.minDistance||0,r.interpolationRatio=0,r.features=[],r.geometryFunction=e.geometryFunction||function(t){var e=t.getGeometry();return assert(e.getType()==GeometryType.POINT,10),e},r.createCustomCluster_=e.createCluster,r.source=null,r.boundRefresh_=r.refresh.bind(r),r.updateDistance(r.distance,r.minDistance),r.setSource(e.source||null),r}return __extends(e,t),e.prototype.clear=function(e){this.features.length=0,t.prototype.clear.call(this,e)},e.prototype.getDistance=function(){return this.distance},e.prototype.getSource=function(){return this.source},e.prototype.loadFeatures=function(t,e,r){this.source.loadFeatures(t,e,r),e!==this.resolution&&(this.resolution=e,this.refresh())},e.prototype.setDistance=function(t){this.updateDistance(t,this.minDistance)},e.prototype.setMinDistance=function(t){this.updateDistance(this.distance,t)},e.prototype.getMinDistance=function(){return this.minDistance},e.prototype.setSource=function(t){this.source&&this.source.removeEventListener(EventType.CHANGE,this.boundRefresh_),this.source=t,t&&t.addEventListener(EventType.CHANGE,this.boundRefresh_),this.refresh()},e.prototype.refresh=function(){this.clear(),this.cluster(),this.addFeatures(this.features)},e.prototype.updateDistance=function(t,e){var r=0===t?0:Math.min(e,t)/t,o=t!==this.distance||this.interpolationRatio!==r;this.distance=t,this.minDistance=e,this.interpolationRatio=r,o&&this.refresh()},e.prototype.cluster=function(){if(void 0!==this.resolution&&this.source)for(var t=createEmpty(),e=this.distance*this.resolution,r=this.source.getFeatures(),o={},i=0,n=r.length;i<n;i++){var s=r[i];if(!(getUid(s)in o)){var a=this.geometryFunction(s);if(a){var u=a.getCoordinates();createOrUpdateFromCoordinate(u,t),buffer(t,e,t);var c=this.source.getFeaturesInExtent(t).filter((function(t){var e=getUid(t);return!(e in o)&&(o[e]=!0,!0)}));this.features.push(this.createCluster(c,t))}}}},e.prototype.createCluster=function(t,e){for(var r=[0,0],o=t.length-1;o>=0;--o){var i=this.geometryFunction(t[o]);i?addCoordinate(r,i.getCoordinates()):t.splice(o,1)}scaleCoordinate(r,1/t.length);var n=getCenter(e),s=this.interpolationRatio,a=new Point([r[0]*(1-s)+n[0]*s,r[1]*(1-s)+n[1]*s]);return this.createCustomCluster_?this.createCustomCluster_(a,t):new Feature({geometry:a,features:t})},e}(VectorSource);export default Cluster;
//# sourceMappingURL=/sm/11c4cd8aefab2e2b0137f219b568549700597e5bdfe74a156e6b12fefb1969cc.map