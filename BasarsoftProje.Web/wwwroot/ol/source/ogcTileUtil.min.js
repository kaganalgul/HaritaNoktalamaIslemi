/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/ogcTileUtil.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import TileGrid from"../tilegrid/TileGrid.js";import{assign}from"../obj.js";import{getJSON,resolveUrl}from"../net.js";import{get as getProjection}from"../proj.js";import{getIntersection as intersectExtents}from"../extent.js";var knownMapMediaTypes={"image/png":!0,"image/jpeg":!0,"image/gif":!0,"image/webp":!0},knownVectorMediaTypes={"application/vnd.mapbox-vector-tile":!0,"application/geo+json":!0};export function getMapTileUrlTemplate(e,t){for(var i,r,n=0;n<e.length;++n){var o=e[n];if("item"===o.rel){if(o.type===t){i=o.href;break}knownMapMediaTypes[o.type]?r=o.href:r||0!==o.type.indexOf("image/")||(r=o.href)}}if(!i){if(!r)throw new Error('Could not find "item" link');i=r}return i}export function getVectorTileUrlTemplate(e,t,i){for(var r,n,o={},l=0;l<e.length;++l){var a=e[l];if(o[a.type]=a.href,"item"===a.rel){if(a.type===t){r=a.href;break}knownVectorMediaTypes[a.type]&&(n=a.href)}}if(!r&&i)for(l=0;l<i.length;++l){var p=i[l];if(o[p]){r=o[p];break}}if(!r){if(!n)throw new Error('Could not find "item" link');r=n}return r}function parseTileMatrixSet(e,t,i,r){var n=e.projection;if(!n&&!(n=getProjection(t.crs)))throw new Error("Unsupported CRS: "+t.crs);for(var o="en"!==n.getAxisOrientation().substr(0,2),l=t.tileMatrices,a={},p=0;p<l.length;++p){var f=l[p];a[f.id]=f}var s={},g=[];if(r)for(p=0;p<r.length;++p){var m=(v=r[p]).tileMatrix;g.push(m),s[m]=v}else for(p=0;p<l.length;++p){m=l[p].id;g.push(m)}var c=g.length,d=new Array(c),T=new Array(c),u=new Array(c),w=new Array(c),h=[-1/0,-1/0,1/0,1/0];for(p=0;p<c;++p){m=g[p];var v,x=(f=a[m]).pointOfOrigin;if(d[p]=o?[x[1],x[0]]:x,T[p]=f.cellSize,u[p]=[f.matrixWidth,f.matrixHeight],w[p]=[f.tileWidth,f.tileHeight],v=s[m]){var M=f.cellSize*f.tileWidth,y=d[p][0]+v.minTileCol*M,S=d[p][0]+(v.maxTileCol+1)*M,k=f.cellSize*f.tileHeight,j=void 0,O=void 0;"bottomLeft"===f.cornerOfOrigin?(j=d[p][1]+v.minTileRow*k,O=d[p][1]+(v.maxTileRow+1)*k):(j=d[p][1]-(v.maxTileRow+1)*k,O=d[p][1]-v.minTileRow*k),intersectExtents(h,[y,j,S,O],h)}}var b=new TileGrid({origins:d,resolutions:T,sizes:u,tileSizes:w,extent:r?h:void 0}),C=e.context,R=e.url;return{grid:b,urlTemplate:i,urlFunction:function(e,t,n){if(e){var o=g[e[0]],l=a[o],p="bottomLeft"===l.cornerOfOrigin,f={tileMatrix:o,tileCol:e[1],tileRow:p?-e[2]-1:e[2]};if(r){var m=s[l.id];if(f.tileCol<m.minTileCol||f.tileCol>m.maxTileCol||f.tileRow<m.minTileRow||f.tileRow>m.maxTileRow)return}assign(f,C);var c=i.replace(/\{(\w+?)\}/g,(function(e,t){return f[t]}));return resolveUrl(R,c)}}}}function parseTileSetMetadata(e,t){var i,r=t.tileMatrixSetLimits;if("map"===t.dataType)i=getMapTileUrlTemplate(t.links,e.mediaType);else{if("vector"!==t.dataType)throw new Error('Expected tileset data type to be "map" or "vector"');i=getVectorTileUrlTemplate(t.links,e.mediaType,e.supportedMediaTypes)}if(t.tileMatrixSet)return parseTileMatrixSet(e,t.tileMatrixSet,i,r);var n=t.links.find((function(e){return"http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme"===e.rel}));if(!n)throw new Error("Expected http://www.opengis.net/def/rel/ogc/1.0/tiling-scheme link or tileMatrixSet");var o=n.href,l=resolveUrl(e.url,o);return getJSON(l).then((function(t){return parseTileMatrixSet(e,t,i,r)}))}export function getTileSetInfo(e){return getJSON(e.url).then((function(t){return parseTileSetMetadata(e,t)}))}
//# sourceMappingURL=/sm/dbb96c732c75ddf75cad70260787218811c3b68ec3102b376c77668973edc4b5.map