/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/ImageMapGuide.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,i){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])},t(e,i)};return function(e,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();import EventType from"../events/EventType.js";import ImageSource,{defaultImageLoadFunction}from"./Image.js";import ImageWrapper from"../Image.js";import{appendParams}from"../uri.js";import{assign}from"../obj.js";import{containsExtent,getCenter,getHeight,getWidth,scaleFromCenter}from"../extent.js";var ImageMapGuide=function(t){function e(e){var i=this,n=void 0===e.imageSmoothing||e.imageSmoothing;return void 0!==e.interpolate&&(n=e.interpolate),(i=t.call(this,{interpolate:n,projection:e.projection,resolutions:e.resolutions})||this).crossOrigin_=void 0!==e.crossOrigin?e.crossOrigin:null,i.displayDpi_=void 0!==e.displayDpi?e.displayDpi:96,i.params_=e.params||{},i.url_=e.url,i.imageLoadFunction_=void 0!==e.imageLoadFunction?e.imageLoadFunction:defaultImageLoadFunction,i.hidpi_=void 0===e.hidpi||e.hidpi,i.metersPerUnit_=void 0!==e.metersPerUnit?e.metersPerUnit:1,i.ratio_=void 0!==e.ratio?e.ratio:1,i.useOverlay_=void 0!==e.useOverlay&&e.useOverlay,i.image_=null,i.renderedRevision_=0,i}return __extends(e,t),e.prototype.getParams=function(){return this.params_},e.prototype.getImageInternal=function(t,e,i,n){e=this.findNearestResolution(e),i=this.hidpi_?i:1;var r=this.image_;if(r&&this.renderedRevision_==this.getRevision()&&r.getResolution()==e&&r.getPixelRatio()==i&&containsExtent(r.getExtent(),t))return r;1!=this.ratio_&&(t=t.slice(),scaleFromCenter(t,this.ratio_));var o=[getWidth(t)/e*i,getHeight(t)/e*i];if(void 0!==this.url_){var a=this.getUrl(this.url_,this.params_,t,o,n);(r=new ImageWrapper(t,e,i,a,this.crossOrigin_,this.imageLoadFunction_)).addEventListener(EventType.CHANGE,this.handleImageChange.bind(this))}else r=null;return this.image_=r,this.renderedRevision_=this.getRevision(),r},e.prototype.getImageLoadFunction=function(){return this.imageLoadFunction_},e.prototype.updateParams=function(t){assign(this.params_,t),this.changed()},e.prototype.getUrl=function(t,e,i,n,r){var o=getScale(i,n,this.metersPerUnit_,this.displayDpi_),a=getCenter(i),s={OPERATION:this.useOverlay_?"GETDYNAMICMAPOVERLAYIMAGE":"GETMAPIMAGE",VERSION:"2.0.0",LOCALE:"en",CLIENTAGENT:"ol/source/ImageMapGuide source",CLIP:"1",SETDISPLAYDPI:this.displayDpi_,SETDISPLAYWIDTH:Math.round(n[0]),SETDISPLAYHEIGHT:Math.round(n[1]),SETVIEWSCALE:o,SETVIEWCENTERX:a[0],SETVIEWCENTERY:a[1]};return assign(s,e),appendParams(t,s)},e.prototype.setImageLoadFunction=function(t){this.image_=null,this.imageLoadFunction_=t,this.changed()},e}(ImageSource);function getScale(t,e,i,n){var r=getWidth(t),o=getHeight(t),a=e[0],s=e[1],p=.0254/n;return s*r>a*o?r*i/(a*p):o*i/(s*p)}export default ImageMapGuide;
//# sourceMappingURL=/sm/9461cf91ce0d517f8680f2f2f950ae8b55616fb01f049af6cef68c7cf462051a.map