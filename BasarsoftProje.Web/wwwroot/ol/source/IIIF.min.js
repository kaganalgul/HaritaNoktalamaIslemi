/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/IIIF.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])},e(t,r)};return function(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function i(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();import TileGrid from"../tilegrid/TileGrid.js";import TileImage from"./TileImage.js";import{CustomTile}from"./Zoomify.js";import{DEFAULT_TILE_SIZE}from"../tilegrid/common.js";import{Versions}from"../format/IIIFInfo.js";import{assert}from"../asserts.js";import{getTopLeft}from"../extent.js";import{includes}from"../array.js";import{toSize}from"../size.js";function formatPercentage(e){return e.toLocaleString("en",{maximumFractionDigits:10})}var IIIF=function(e){function t(t){var r=this,i=t||{},o=void 0===i.imageSmoothing||i.imageSmoothing;void 0!==i.interpolate&&(o=i.interpolate);var n=i.url||"";n+=n.lastIndexOf("/")===n.length-1||""===n?"":"/";var s=i.version||Versions.VERSION2,l=i.sizes||[],a=i.size;assert(null!=a&&Array.isArray(a)&&2==a.length&&!isNaN(a[0])&&a[0]>0&&!isNaN(a[1])&&a[1]>0,60);var u,c,f,h=a[0],m=a[1],p=i.tileSize,g=i.tilePixelRatio||1,d=i.format||"jpg",y=i.quality||(i.version==Versions.VERSION1?"native":"default"),I=i.resolutions||[],v=i.supports||[],z=i.extent||[0,-m,h,0],_=null!=l&&Array.isArray(l)&&l.length>0,x=void 0!==p&&("number"==typeof p&&Number.isInteger(p)&&p>0||Array.isArray(p)&&p.length>0),T=null!=v&&Array.isArray(v)&&(includes(v,"regionByPx")||includes(v,"regionByPct"))&&(includes(v,"sizeByWh")||includes(v,"sizeByH")||includes(v,"sizeByW")||includes(v,"sizeByPct"));if(I.sort((function(e,t){return t-e})),x||T)if(null!=p&&("number"==typeof p&&Number.isInteger(p)&&p>0?(u=p,c=p):Array.isArray(p)&&p.length>0&&((1==p.length||null==p[1]&&Number.isInteger(p[0]))&&(u=p[0],c=p[0]),2==p.length&&(Number.isInteger(p[0])&&Number.isInteger(p[1])?(u=p[0],c=p[1]):null==p[0]&&Number.isInteger(p[1])&&(u=p[1],c=p[1])))),void 0!==u&&void 0!==c||(u=DEFAULT_TILE_SIZE,c=DEFAULT_TILE_SIZE),0==I.length)for(var b=f=Math.max(Math.ceil(Math.log(h/u)/Math.LN2),Math.ceil(Math.log(m/c)/Math.LN2));b>=0;b--)I.push(Math.pow(2,b));else{var N=Math.max.apply(Math,I);f=Math.round(Math.log(N)/Math.LN2)}else if(u=h,c=m,I=[],_){l.sort((function(e,t){return e[0]-t[0]})),f=-1;var S=[];for(b=0;b<l.length;b++){var j=h/l[b][0];I.length>0&&I[I.length-1]==j?S.push(b):(I.push(j),f++)}if(S.length>0)for(b=0;b<S.length;b++)l.splice(S[b]-b,1)}else I.push(1),l.push([h,m]),f=0;var E=new TileGrid({tileSize:[u,c],extent:z,origin:getTopLeft(z),resolutions:I}),M=CustomTile.bind(null,toSize(p||256).map((function(e){return e*g})));return(r=e.call(this,{attributions:i.attributions,attributionsCollapsible:i.attributionsCollapsible,cacheSize:i.cacheSize,crossOrigin:i.crossOrigin,interpolate:o,projection:i.projection,reprojectionErrorThreshold:i.reprojectionErrorThreshold,state:i.state,tileClass:M,tileGrid:E,tilePixelRatio:i.tilePixelRatio,tileUrlFunction:function(e,t,r){var i,o,a=e[0];if(!(a>f)){var p=e[1],g=e[2],z=I[a];if(!(void 0===p||void 0===g||void 0===z||p<0||Math.ceil(h/z/u)<=p||g<0||Math.ceil(m/z/c)<=g)){if(T||x){var b=p*u*z,N=g*c*z,S=u*z,j=c*z,E=u,M=c;if(b+S>h&&(S=h-b),N+j>m&&(j=m-N),b+u*z>h&&(E=Math.floor((h-b+z-1)/z)),N+c*z>m&&(M=Math.floor((m-N+z-1)/z)),0==b&&S==h&&0==N&&j==m)i="full";else if(!T||includes(v,"regionByPx"))i=b+","+N+","+S+","+j;else if(includes(v,"regionByPct")){i="pct:"+formatPercentage(b/h*100)+","+formatPercentage(N/m*100)+","+formatPercentage(S/h*100)+","+formatPercentage(j/m*100)}s!=Versions.VERSION3||T&&!includes(v,"sizeByWh")?!T||includes(v,"sizeByW")?o=E+",":includes(v,"sizeByH")?o=","+M:includes(v,"sizeByWh")?o=E+","+M:includes(v,"sizeByPct")&&(o="pct:"+formatPercentage(100/z)):o=E+","+M}else if(i="full",_){var P=l[a][0],A=l[a][1];o=s==Versions.VERSION3?P==h&&A==m?"max":P+","+A:P==h?"full":P+","}else o=s==Versions.VERSION3?"max":"full";return n+i+"/"+o+"/0/"+y+"."+d}}},transition:i.transition})||this).zDirection=i.zDirection,r}return __extends(t,e),t}(TileImage);export default IIIF;
//# sourceMappingURL=/sm/71ff4a9072a71ee2e897508f5a294cdbcfcfe846e9d539bde5b822ed015ab68f.map