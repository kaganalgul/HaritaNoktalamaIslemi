/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/Zoomify.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var e=function(t,i){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])},e(t,i)};return function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}e(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();import{DEFAULT_TILE_SIZE}from"../tilegrid/common.js";import ImageTile from"../ImageTile.js";import TileGrid from"../tilegrid/TileGrid.js";import TileImage from"./TileImage.js";import TileState from"../TileState.js";import{assert}from"../asserts.js";import{createCanvasContext2D}from"../dom.js";import{createFromTileUrlFunctions,expandUrl}from"../tileurlfunction.js";import{getCenter}from"../extent.js";import{toSize}from"../size.js";var TierSizeCalculation={DEFAULT:"default",TRUNCATED:"truncated"},CustomTile=function(e){function t(t,i,r,o,n,a,l){var s=e.call(this,i,r,o,n,a,l)||this;return s.zoomifyImage_=null,s.tileSize_=t,s}return __extends(t,e),t.prototype.getImage=function(){if(this.zoomifyImage_)return this.zoomifyImage_;var t=e.prototype.getImage.call(this);if(this.state==TileState.LOADED){var i=this.tileSize_;if(t.width==i[0]&&t.height==i[1])return this.zoomifyImage_=t,t;var r=createCanvasContext2D(i[0],i[1]);return r.drawImage(t,0,0),this.zoomifyImage_=r.canvas,r.canvas}return t},t}(ImageTile);export{CustomTile};var Zoomify=function(e){function t(t){var i=this,r=t,o=void 0===r.imageSmoothing||r.imageSmoothing;void 0!==r.interpolate&&(o=r.interpolate);var n=r.size,a=void 0!==r.tierSizeCalculation?r.tierSizeCalculation:TierSizeCalculation.DEFAULT,l=r.tilePixelRatio||1,s=n[0],u=n[1],c=[],m=r.tileSize||DEFAULT_TILE_SIZE,f=m*l;switch(a){case TierSizeCalculation.DEFAULT:for(;s>f||u>f;)c.push([Math.ceil(s/f),Math.ceil(u/f)]),f+=f;break;case TierSizeCalculation.TRUNCATED:for(var p=s,h=u;p>f||h>f;)c.push([Math.ceil(p/f),Math.ceil(h/f)]),p>>=1,h>>=1;break;default:assert(!1,53)}c.push([1,1]),c.reverse();for(var T=[l],d=[0],g=1,v=c.length;g<v;g++)T.push(l<<g),d.push(c[g-1][0]*c[g-1][1]+d[g-1]);T.reverse();var _=new TileGrid({tileSize:m,extent:r.extent||[0,-u,s,0],resolutions:T}),z=r.url;z&&-1==z.indexOf("{TileGroup}")&&-1==z.indexOf("{tileIndex}")&&(z+="{TileGroup}/{z}-{x}-{y}.jpg");var x=expandUrl(z),S=m*l;var C=createFromTileUrlFunctions(x.map((function(e){return function(t,i,r){if(t){var o=t[0],n=t[1],a=t[2],l=n+a*c[o][0],s={z:o,x:n,y:a,tileIndex:l,TileGroup:"TileGroup"+((l+d[o])/S|0)};return e.replace(/\{(\w+?)\}/g,(function(e,t){return s[t]}))}}}))),I=CustomTile.bind(null,toSize(m*l));(i=e.call(this,{attributions:r.attributions,cacheSize:r.cacheSize,crossOrigin:r.crossOrigin,interpolate:o,projection:r.projection,tilePixelRatio:l,reprojectionErrorThreshold:r.reprojectionErrorThreshold,tileClass:I,tileGrid:_,tileUrlFunction:C,transition:r.transition})||this).zDirection=r.zDirection;var y=C(_.getTileCoordForCoordAndResolution(getCenter(_.getExtent()),T[T.length-1]),1,null),j=new Image;return j.addEventListener("error",function(){S=m,this.changed()}.bind(i)),j.src=y,i}return __extends(t,e),t}(TileImage);export default Zoomify;
//# sourceMappingURL=/sm/12e279a2f26cc260d958cc741f634309f85aeeed38b701669c2bf18c11ba93ac.map