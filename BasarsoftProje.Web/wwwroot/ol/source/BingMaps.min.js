/**
 * Minified by jsDelivr using Terser v5.10.0.
 * Original file: /npm/ol@6.12.0/source/BingMaps.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
var __extends=this&&this.__extends||function(){var t=function(e,r){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},t(e,r)};return function(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Class extends value "+String(r)+" is not a constructor or null");function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();import SourceState from"./State.js";import TileImage from"./TileImage.js";import{applyTransform,intersects}from"../extent.js";import{createFromTileUrlFunctions}from"../tileurlfunction.js";import{createOrUpdate}from"../tilecoord.js";import{createXYZ,extentFromProjection}from"../tilegrid.js";import{get as getProjection,getTransformFromProjections}from"../proj.js";import{jsonp as requestJSONP}from"../net.js";export function quadKey(t){var e,r,o=t[0],i=new Array(o),n=1<<o-1;for(e=0;e<o;++e)r=48,t[1]&n&&(r+=1),t[2]&n&&(r+=2),i[e]=String.fromCharCode(r),n>>=1;return i.join("")}var TOS_ATTRIBUTION='<a class="ol-attribution-bing-tos" href="https://www.microsoft.com/maps/product/terms.html" target="_blank">Terms of Use</a>',BingMaps=function(t){function e(e){var r=this,o=void 0!==e.hidpi&&e.hidpi,i=void 0===e.imageSmoothing||e.imageSmoothing;void 0!==e.interpolate&&(i=e.interpolate),(r=t.call(this,{cacheSize:e.cacheSize,crossOrigin:"anonymous",interpolate:i,opaque:!0,projection:getProjection("EPSG:3857"),reprojectionErrorThreshold:e.reprojectionErrorThreshold,state:SourceState.LOADING,tileLoadFunction:e.tileLoadFunction,tilePixelRatio:o?2:1,wrapX:void 0===e.wrapX||e.wrapX,transition:e.transition,zDirection:e.zDirection})||this).hidpi_=o,r.culture_=void 0!==e.culture?e.culture:"en-us",r.maxZoom_=void 0!==e.maxZoom?e.maxZoom:-1,r.apiKey_=e.key,r.imagerySet_=e.imagerySet;var n="https://dev.virtualearth.net/REST/v1/Imagery/Metadata/"+r.imagerySet_+"?uriScheme=https&include=ImageryProviders&key="+r.apiKey_+"&c="+r.culture_;return requestJSONP(n,r.handleImageryMetadataResponse.bind(r),void 0,"jsonp"),r}return __extends(e,t),e.prototype.getApiKey=function(){return this.apiKey_},e.prototype.getImagerySet=function(){return this.imagerySet_},e.prototype.handleImageryMetadataResponse=function(t){if(200==t.statusCode&&"OK"==t.statusDescription&&"ValidCredentials"==t.authenticationResultCode&&1==t.resourceSets.length&&1==t.resourceSets[0].resources.length){var e=t.resourceSets[0].resources[0],r=-1==this.maxZoom_?e.zoomMax:this.maxZoom_,o=this.getProjection(),i=extentFromProjection(o),n=this.hidpi_?2:1,a=e.imageWidth==e.imageHeight?e.imageWidth/n:[e.imageWidth/n,e.imageHeight/n],s=createXYZ({extent:i,minZoom:e.zoomMin,maxZoom:r,tileSize:a});this.tileGrid=s;var c=this.culture_,u=this.hidpi_;if(this.tileUrlFunction=createFromTileUrlFunctions(e.imageUrlSubdomains.map((function(t){var r=[0,0,0],o=e.imageUrl.replace("{subdomain}",t).replace("{culture}",c);return function(t,e,i){if(t){createOrUpdate(t[0],t[1],t[2],r);var n=o;return u&&(n+="&dpi=d1&device=mobile"),n.replace("{quadkey}",quadKey(r))}}}))),e.imageryProviders){var m=getTransformFromProjections(getProjection("EPSG:4326"),this.getProjection());this.setAttributions(function(t){var r=[],o=t.viewState,i=this.getTileGrid(),n=i.getZForResolution(o.resolution,this.zDirection),a=i.getTileCoordForCoordAndZ(o.center,n)[0];return e.imageryProviders.map((function(e){for(var o=!1,i=e.coverageAreas,n=0,s=i.length;n<s;++n){var c=i[n];if(a>=c.zoomMin&&a<=c.zoomMax){var u=c.bbox,p=[u[1],u[0],u[3],u[2]],l=applyTransform(p,m);if(intersects(l,t.extent)){o=!0;break}}}o&&r.push(e.attribution)})),r.push(TOS_ATTRIBUTION),r}.bind(this))}this.setState(SourceState.READY)}else this.setState(SourceState.ERROR)},e}(TileImage);export default BingMaps;
//# sourceMappingURL=/sm/fc3d7f86324204b0db984d19309f0ce5ccde557af421faa59b0cdbca6e34f69f.map